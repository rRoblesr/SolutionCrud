@*@{
    ViewData["Title"] = "Home Page";
}*@

@*<div class="text-center">
    <h1 class="display-4">Welcome</h1>
    <p>Learn about <a href="https://docs.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>
</div>*@


<div class="row">
    <div class="col-sm-12">

        <!--Inicio tarjeta-->
        <div class="card">
            <div class="card-header">Contactos</div>
            <div class="card-body">

                <button class="btn btn-success" id="btnNuevo">Nuevo Contacto</button>

                <hr />

                <table class="table table-striped" id="tbContacto">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Telefono</th>
                            <th>Fecha Nacimiento</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>

            </div>
        </div>
        <!--Fin tarjeta-->

    </div>
</div>

<!--Inicio Modal-->
<div class="modal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Detalle Contacto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="id" value="0" />
                <div class="mb-2">
                    <label>Nombre</label>
                    <input type="text" class="form-control" id="nombre" />
                </div>
                <div class="mb-2">
                    <label>Telefono</label>
                    <input type="text" class="form-control" id="telefono" />
                </div>
                <div class="mb-2">
                    <label>Fecha Nacimiento</label>
                    <input type="text" class="form-control" id="nacimiento" />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnGuardar">Guardar</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>
<!--Fin Modal-->

@section Scripts{
    <script>
        const modelo_base={
            id:"0",
            nombre:"",
            telefono:"",
            nacimiento:""
        }

        function mostrarmodal(modelo){
            $('#id').val(modelo.id);
            $('#nombre').val(modelo.nombre);
            $('#telefono').val(modelo.telefono);
            $('#nacimiento').val(modelo.nacimiento);

            $('.modal').modal('show');
        }

        $('#btnNuevo').click(()=>{
            mostrarmodal(modelo_base);
        });

        $('#btnGuardar').click(()=>{
            console.log("aqui tamos");
            console.log("aqui tamos");
            console.log("aqui tamos");
            console.log("aqui tamos");
            console.log("aqui tamos");
            let nm=modelo_base;
            nm['id'] = $('#id').val();
            nm['nombre'] = $('#nombre').val();
            nm['telefono'] = $('#telefono').val();
            nm['nacimiento'] = $('#nacimiento').val();

              if(nm['id']=="0"){
                  fetch("Home/insertar",{
                      method:"POST",
                      header:{
                          "Content-Type":"application/json;charset=utf-8"
                      },
                      body:JSON.stringify(nm),
                  }).
                  then((response)=>{
                      console.log(response);
                      return response.ok?response.json():Promise.reject(response);
                  }).
                  then((data)=>{
                      if(data.valor){
                          alert("registrado");
                          $(".modal").model("hide");
                      }
                  });
              }else{
                  //fecth("");
              }

        });

    </script>
}
